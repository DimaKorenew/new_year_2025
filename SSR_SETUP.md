# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSG/ISR/SSR

–ü—Ä–æ–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ç—Ä–µ—Ö —Ä–µ–∂–∏–º–æ–≤ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞:

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. SSG (Static Site Generation)
- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (`/`, `/new-year-2025/`) –ø—Ä–µ–¥—Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ —Å–±–æ—Ä–∫–∏
- –ë—ã—Å—Ç—Ä–∞—è –æ—Ç–¥–∞—á–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ HTML
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å —Ä–µ–¥–∫–∏–º–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏

### 2. ISR (Incremental Static Regeneration)
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (`/s/:shareId`) –∫—ç—à–∏—Ä—É—é—Ç—Å—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—ç—à–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1 —á–∞—Å)

### 3. SSR (Server-Side Rendering)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫—Ä–∞—É–ª–µ—Ä–æ–≤ (Google, Yandex, Bing –∏ –¥—Ä.)
- –û–¥–∏–Ω–∞–∫–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫—Ä–∞—É–ª–µ—Ä–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –∫—Ä–∞—É–ª–µ—Ä–æ–≤

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –û–±—ã—á–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (CSR)
npm run dev

# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å SSR
npm run dev:ssr
```

### –°–±–æ—Ä–∫–∞

```bash
# –ü–æ–ª–Ω–∞—è —Å–±–æ—Ä–∫–∞ (–∫–ª–∏–µ–Ω—Ç + —Å–µ—Ä–≤–µ—Ä + prerender)
npm run build

# –ò–ª–∏ –ø–æ —à–∞–≥–∞–º:
npm run build:client      # –°–±–æ—Ä–∫–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –±–∞–Ω–¥–ª–∞
npm run build:server      # –°–±–æ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –±–∞–Ω–¥–ª–∞  
npm run build:prerender   # –ü—Ä–µ–¥—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
```

### –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä

```bash
# –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–±–æ—Ä–∫–∏
npm run preview

# –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å SSR
npm run preview:ssr
```

## üìã –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:

```env
NODE_ENV=production
PORT=5174
ISR_REVALIDATE=3600  # –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—ç—à–∞ ISR –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
FORCE_SSR=false      # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π SSR –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
```

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫—Ä–∞—É–ª–µ—Ä–æ–≤

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∫—Ä–∞—É–ª–µ—Ä—ã:
- **Google**: Googlebot, Google-InspectionTool, Mediapartners-Google
- **Yandex**: YandexBot, YandexMobileBot, YandexImages –∏ –¥—Ä.
- **Bing**: Bingbot, MSNBot
- **–î—Ä—É–≥–∏–µ**: Baidu, DuckDuckBot, Facebook, Twitter, LinkedIn –∏ –¥—Ä.

–î–ª—è –∫—Ä–∞—É–ª–µ—Ä–æ–≤ –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SSR –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Nginx/CDN     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Static‚îÇ ‚îÇ  SSR   ‚îÇ
‚îÇ  HTML ‚îÇ ‚îÇ Server ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚îÇ         ‚îÇ
    ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ    ‚îÇ   ISR   ‚îÇ
    ‚îÇ    ‚îÇ  Cache  ‚îÇ
    ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Client     ‚îÇ
‚îÇ  Hydration   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/
  entry-client.tsx          # –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π entry (–≥–∏–¥—Ä–∞—Ç–∞—Ü–∏—è)
  entry-server.tsx          # –°–µ—Ä–≤–µ—Ä–Ω—ã–π entry (SSR)
  utils/
    crawlerDetection.ts     # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫—Ä–∞—É–ª–µ—Ä–æ–≤

server/
  ssr.js                    # SSR —Å–µ—Ä–≤–µ—Ä
  isr.js                    # ISR middleware

scripts/
  prerender.js              # –°–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞

dist/
  client/                   # –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –±–∞–Ω–¥–ª
  server/                   # –°–µ—Ä–≤–µ—Ä–Ω—ã–π –±–∞–Ω–¥–ª
  .isr-cache/              # –ö—ç—à ISR (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```

## üîç –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (SSG)
1. –ü—Ä–∏ —Å–±–æ—Ä–∫–µ (`npm run build`) —Å—Ç—Ä–∞–Ω–∏—Ü—ã `/` –∏ `/new-year-2025/` –ø—Ä–µ–¥—Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è
2. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ HTML —Ñ–∞–π–ª—ã
3. Nginx –æ—Ç–¥–∞–µ—Ç –∏—Ö –Ω–∞–ø—Ä—è–º—É—é (–±—ã—Å—Ç—Ä–æ)

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (ISR)
1. –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –∫ `/s/:shareId` —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
2. –†–µ–∑—É–ª—å—Ç–∞—Ç –∫—ç—à–∏—Ä—É–µ—Ç—Å—è –≤ `.isr-cache/`
3. –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã –æ—Ç–¥–∞—é—Ç –∫—ç—à (–±—ã—Å—Ç—Ä–æ)
4. –ü–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –∫—ç—à–∞:
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –æ—Ç–¥–∞–µ—Ç—Å—è —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –∫—ç—à
   - –í —Ñ–æ–Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
   - –°–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å –ø–æ–ª—É—á–∏—Ç —Å–≤–µ–∂–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç

### SSR –¥–ª—è –∫—Ä–∞—É–ª–µ—Ä–æ–≤
1. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç User-Agent –∑–∞–ø—Ä–æ—Å–∞
2. –ï—Å–ª–∏ —ç—Ç–æ –∫—Ä–∞—É–ª–µ—Ä ‚Üí –ø–æ–ª–Ω—ã–π SSR
3. –ï—Å–ª–∏ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π HTML (–±—ã—Å—Ç—Ä–µ–µ)
4. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –≤—Å–µ—Ö

## üê≥ Docker

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è SSR –≤ Docker –¥–æ–±–∞–≤—å—Ç–µ —Å–µ—Ä–≤–∏—Å:

```yaml
ssr-server:
  build:
    context: .
    dockerfile: Dockerfile.ssr
  ports:
    - "5174:5174"
  environment:
    - NODE_ENV=production
    - PORT=5174
    - ISR_REVALIDATE=3600
  networks:
    - app-network
```

–ò –æ–±–Ω–æ–≤–∏—Ç–µ nginx.conf –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –∫ SSR —Å–µ—Ä–≤–µ—Ä—É (—Å–º. `nginx.conf.ssr`).

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- ‚úÖ **SEO**: –ü–æ–ª–Ω—ã–π HTML –¥–ª—è –∫—Ä–∞—É–ª–µ—Ä–æ–≤
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –°—Ç–∞—Ç–∏–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: ISR –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- ‚úÖ **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –û–¥–∏–Ω–∞–∫–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –≤—Å–µ—Ö
- ‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- ISR –∫—ç—à —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `.isr-cache/` (–¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ `.gitignore`)
- –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å-–º–µ–Ω–µ–¥–∂–µ—Ä (PM2)
- SSR —Å–µ—Ä–≤–µ—Ä –º–æ–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ
- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –º–æ–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ CDN


